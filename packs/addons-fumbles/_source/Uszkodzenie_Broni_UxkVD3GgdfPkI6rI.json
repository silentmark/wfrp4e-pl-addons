{
  "name": "Uszkodzenie Broni",
  "type": "critical",
  "_id": "UxkVD3GgdfPkI6rI",
  "img": "icons/skills/melee/shield-damaged-broken-blue.webp",
  "system": {
    "description": {
      "type": "String",
      "label": "Description",
      "value": "<p>Broń ulega uszkodzeniu i otrzymuje 1 punkt uszkodzeń</p>"
    },
    "gmdescription": {
      "type": "String",
      "label": "Description",
      "value": ""
    },
    "wounds": {
      "value": "0",
      "type": "String",
      "label": "Wounds"
    },
    "modifier": {
      "value": "",
      "type": "String",
      "label": "Test Modifier"
    },
    "location": {
      "value": "",
      "type": "String",
      "label": "Location"
    }
  },
  "effects": [
    {
      "icon": "icons/skills/melee/shield-damaged-broken-blue.webp",
      "transfer": true,
      "name": "Uszkodzenie Broni",
      "_id": "c4KDNOxrVyjsYLHR",
      "changes": [],
      "disabled": false,
      "duration": {
        "startTime": null,
        "seconds": null,
        "combat": null,
        "rounds": null,
        "turns": null,
        "startRound": null,
        "startTurn": null
      },
      "description": "",
      "origin": null,
      "statuses": [],
      "flags": {
        "times-up": {
          "isPassive": true
        },
        "wfrp4e": {
          "effectTrigger": "oneTime",
          "effectApplication": "actor",
          "hide": false,
          "preventDuplicateEffects": false,
          "script": "const weapons = this.actor.items.filter(x=>x.equipped && x.type == \"weapon\");\nconst weapon = weapons[Math.floor(Math.random() * weapons.length)];\nconst w = weapon.toObject();\nlet regex = /\\d{1,3}/gm;\nconst maxDamage = Number(regex.exec(weapon.damage.value)[0] || 0) + Number(weapon.properties.qualities.durable?.value || 0) || 999\nw.system.damageToItem.value = Math.min(maxDamage, w.system.damageToItem.value + 1);\nif (maxDamage == w.system.damageToItem.value) {\n    w.system.equipped = false\n}\nthis.actor.updateEmbeddedDocuments(\"Item\", [w]);\n\nconst target = this.actor;\nconst effectName = this.effect.name;\nsetTimeout(() => {\n    let itm = target.getItemTypes(\"critical\").find(x=>x.name == effectName);\n    target.deleteEmbeddedDocuments(\"Item\", [itm.id])\n}, 500);"
        }
      },
      "tint": null,
      "_key": "!items.effects!UxkVD3GgdfPkI6rI.c4KDNOxrVyjsYLHR"
    }
  ],
  "folder": null,
  "sort": 0,
  "ownership": {
    "default": 0,
    "Czz7IJA9DEa5LD9E": 3
  },
  "flags": {},
  "_stats": {
    "systemId": "wfrp4e",
    "systemVersion": "6.5.9",
    "coreVersion": "11.305",
    "createdTime": 1689672604423,
    "modifiedTime": 1689795791699,
    "lastModifiedBy": "Czz7IJA9DEa5LD9E"
  },
  "_key": "!items!UxkVD3GgdfPkI6rI"
}
